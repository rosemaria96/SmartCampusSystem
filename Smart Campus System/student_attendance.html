<!DOCTYPE html>
<html lang="en">

<head>
    <title>Student Attendance | Campus Pro</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Custom CSS -->
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <div class="d-flex app-layout">

        <!-- Sidebar -->
        <div class="sidebar">

            <!-- Logo -->
            <div class="sidebar-logo">
                <img src="logo.png" alt="Cruz Horizon Logo" style="width: 40px; height: auto;">
                <div class="ms-2">
                    <div class="fw-bold fs-5 logo-text">Cruz Horizon</div>
                    <div class="logo-subtitle" style="font-size: 0.8rem;">Student Portal</div>
                </div>
            </div>

            <ul class="menu">
                <li class="menu-item" onclick="window.location.href='student_dashboard.html'"><i
                        class="bi bi-grid-fill me-2"></i> Dashboard</li>
                <li class="menu-item active" onclick="window.location.href='student_attendance.html'"><i
                        class="bi bi-person-check me-2"></i> Attendance</li>
                <li class="menu-item" onclick="window.location.href='student_timetable.html'"><i
                        class="bi bi-calendar-week me-2"></i> Timetable</li>
                <li class="menu-item" onclick="window.location.href='student_academics.html'"><i
                        class="bi bi-book me-2"></i> Academic</li>
                <li class="menu-item" onclick="window.location.href='student_notifications.html'"><i
                        class="bi bi-bell me-2"></i> Notifications</li>
                <li class="menu-item" onclick="window.location.href='student_question_bank.html'"><i
                        class="bi bi-question-circle me-2"></i> Question Bank</li>
                <li class="menu-item" onclick="window.location.href='student_fee_payment.html'"><i
                        class="bi bi-wallet2 me-2"></i> Fee Payment</li>
                <li class="menu-item text-danger mt-3" onclick="window.location.href='index.html'"><i
                        class="bi bi-box-arrow-right me-2"></i> Logout</li>
            </ul>

            <!-- User Profile in Sidebar (Bottom) -->
            <div class="mt-auto pt-4 border-top border-secondary">
                <div class="d-flex align-items-center profile-text">
                    <div class="rounded-circle bg-primary text-white d-flex align-items-center justify-content-center"
                        style="width: 40px; height: 40px;">
                        J
                    </div>
                    <div class="ms-2">
                        <div class="fw-bold" style="font-size: 0.9rem;">John Doe</div>
                        <div class="text-muted-custom" style="font-size: 0.75rem;">john@example.com</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">

            <!-- Top Navbar -->
            <div class="topbar mb-4">
                <!-- Search -->
                <div class="search-bar flex-grow-1 me-4">
                    <div class="input-group">
                        <span class="input-group-text bg-white border-0"><i class="bi bi-search"></i></span>
                        <input type="text" class="form-control border-0" placeholder="Search...">
                    </div>
                </div>

                <div class="topbar-actions align-items-center">
                    <button id="toggleBtn" class="toggle-btn me-2"><i class="bi bi-moon-fill"></i></button>
                    <div class="position-relative me-3">
                        <i class="bi bi-bell fs-5"></i>
                        <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"
                            style="font-size: 0.6rem;">3</span>
                    </div>
                    <div class="rounded-circle border border-2 border-primary p-1">
                        <div class="rounded-circle bg-primary text-white d-flex align-items-center justify-content-center fw-bold"
                            style="width: 32px; height: 32px;">J</div>
                    </div>
                </div>
            </div>

            <!-- Page Header -->
            <div class="mb-4">
                <h2 class="fw-bold mb-1">My Attendance</h2>
                <p class="text-white-50">View your attendance records and statistics</p>
            </div>

            <!-- Stats Cards Row -->
            <div class="row g-4 mb-4">
                <!-- Overall Attendance -->
                <div class="col-md-4">
                    <div class="stat-card text-center">
                        <p class="text-muted mb-2">Overall Attendance</p>
                        <h1 class="fw-bold text-primary mb-3 display-4">94.5%</h1>
                        <div class="progress mb-2" style="height: 10px;">
                            <div class="progress-bar bg-primary" role="progressbar" style="width: 94.5%"></div>
                        </div>
                    </div>
                </div>

                <!-- Classes Attended -->
                <div class="col-md-4">
                    <div class="stat-card text-center">
                        <p class="text-muted mb-2">Classes Attended</p>
                        <h1 class="fw-bold text-success mb-2 display-4">142</h1>
                        <p class="text-muted small">out of 150 classes</p>
                    </div>
                </div>

                <!-- Absent Days -->
                <div class="col-md-4">
                    <div class="stat-card text-center">
                        <p class="text-muted mb-2">Absent Days</p>
                        <h1 class="fw-bold text-danger mb-2 display-4">8</h1>
                        <p class="text-muted small">this semester</p>
                    </div>
                </div>
            </div>

            <!-- Attendance Trend Chart -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="content-card">
                        <h5 class="fw-bold mb-4">Attendance Trend</h5>
                        <div style="height: 300px; width: 100%;">
                            <canvas id="attendanceChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recent Attendance Records -->
            <div class="row">
                <div class="col-12">
                    <div class="content-card">
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <h5 class="fw-bold mb-0">Recent Attendance Records</h5>
                            <button class="btn btn-outline-secondary btn-sm d-flex align-items-center gap-2">
                                <i class="bi bi-funnel"></i> Filter
                            </button>
                        </div>

                        <div class="table-responsive">
                            <table class="table table-hover align-middle custom-table">
                                <thead>
                                    <tr>
                                        <th scope="col" class="text-muted small text-uppercase">Date</th>
                                        <th scope="col" class="text-muted small text-uppercase">Subject</th>
                                        <th scope="col" class="text-muted small text-uppercase text-end">Status</th>
                                    </tr>
                                </thead>
                                <tbody class="border-top-0">
                                    <tr>
                                        <td>2024-01-15</td>
                                        <td>Mathematics</td>
                                        <td class="text-end"><span class="badge badge-presence-present">present</span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>2024-01-14</td>
                                        <td>Physics</td>
                                        <td class="text-end"><span class="badge badge-presence-present">present</span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>2024-01-13</td>
                                        <td>Chemistry</td>
                                        <td class="text-end"><span class="badge badge-presence-absent">absent</span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>2024-01-12</td>
                                        <td>English</td>
                                        <td class="text-end"><span class="badge badge-presence-present">present</span>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>2024-01-11</td>
                                        <td>Mathematics</td>
                                        <td class="text-end"><span class="badge badge-presence-present">present</span>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- Bootstrap & Custom Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Dark Mode Logic (Copied from dashboard.js logic usually, but simplified here)
        const toggleBtn = document.getElementById("toggleBtn");

        // Check local storage
        if (localStorage.getItem("theme") === "light") {
            document.body.classList.add("light-mode");
            toggleBtn.classList.add("active");
        }

        toggleBtn.addEventListener("click", () => {
            document.body.classList.toggle("light-mode");
            toggleBtn.classList.toggle("active");

            localStorage.setItem("theme", document.body.classList.contains("light-mode") ? "light" : "dark");
            updateChartTheme();
        });

        // Initialize Chart
        const ctx = document.getElementById('attendanceChart').getContext('2d');
        let chartInstance;

        function initChart() {
            const isLight = document.body.classList.contains("light-mode");
            const gridColor = isLight ? '#e2e8f0' : '#334155';
            const textColor = isLight ? '#64748b' : '#94a3b8';

            if (chartInstance) {
                chartInstance.destroy();
            }

            chartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                    datasets: [{
                        label: 'Attendance %',
                        data: [98, 95, 99, 97, 98, 96],
                        borderColor: '#3b82f6', // Primary Blue
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        tension: 0.4,
                        pointBackgroundColor: '#ffffff',
                        pointBorderColor: '#3b82f6',
                        pointBorderWidth: 2,
                        pointRadius: 4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            grid: {
                                color: gridColor,
                                borderDash: [5, 5]
                            },
                            ticks: {
                                color: textColor
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                color: textColor
                            }
                        }
                    }
                }
            });
        }

        function updateChartTheme() {
            initChart();
        }

        // Initialize on load
        initChart();

    </script>
</body>

</html>